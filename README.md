# Обучение с учителем

Из банка стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.

Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Есть исторические данные о поведении клиентов и расторжении договоров с банком. 

В ходе проекта были изучены данные, обработаны пропуски (использовался IterativeImputer). Далее данные были разбиты на выборки - обучающую, валидационную и тестовую. Категориальные признаки – закодированы (использлвался OneHotEncoder). Числовые – промасштабируемы с учетом выбросов (использовался RobustScaler). Чтобы избежать утечки данных, кодирочщики обучались только на обучающей выборке. 

Следующим шагом был обнаружен и проанализирован дисбаланс классов. Решая задачу классификации были обучены три модели – Логистическая регрессия, Дерево решений, Случайный лес. Сначала были получены результаты без учета дисбаланса классов. Результаты были неудовлетворительны. Ни одна модель не достигла нужного значения F1-меры. 

Далее были рассмотрены три варианта борьбы с дисбалансом классов – Взвешивание классов, Увеличение выборки, Уменьшение выборки. Получилось добиться желаемого результата на валидационной выборке после обучения модели Случайного леса, когда использовалось взвешивание классов. Метрика AUC-ROC также оказалась наивысшей в этом случае среди всех рассмотренных. 

Модель была проверена на тестовой выборке и подтвердила своё качество. Метрики оказались ещё выше, чем на валидационной выборке. 
